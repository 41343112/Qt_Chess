# 設定面板測試指南

## 測試環境準備

### 必需條件
- Qt5 開發環境已安裝
- Qt WebSockets 模組已安裝
- 編譯器支援 C++17

### 編譯步驟
```bash
qmake Qt_Chess.pro
make
./Qt_Chess
```

## 功能測試清單

### 1. 基本UI測試

#### 1.1 設定面板顯示
- [ ] 點擊「設定」選單 > 「音效設定」，驗證設定面板顯示
- [ ] 驗證標籤頁顯示為「🔊 音效設定」、「♟️ 棋子圖標」、「🎨 棋盤顏色」
- [ ] 驗證左上角有「← 返回遊戲」按鈕
- [ ] 驗證標題顯示「⚙️ 遊戲設定」

#### 1.2 面板切換
- [ ] 點擊「設定」> 「棋子圖標設定」，驗證直接跳到棋子圖標標籤頁
- [ ] 點擊「設定」> 「棋盤顏色設定」，驗證直接跳到棋盤顏色標籤頁
- [ ] 在設定面板中手動切換標籤頁，驗證所有標籤頁內容正常顯示

#### 1.3 返回機制
- [ ] 點擊「← 返回遊戲」按鈕，驗證返回主遊戲畫面
- [ ] 按 ESC 鍵，驗證返回主遊戲畫面
- [ ] 在主遊戲畫面按 ESC 鍵，驗證不會有異常行為

### 2. 音效設定測試

#### 2.1 全部音效開關
- [ ] 取消勾選「🔊 啟用所有音效」，驗證：
  - 所有個別音效複選框被取消勾選
  - 遊戲中所有音效停止播放
- [ ] 重新勾選「🔊 啟用所有音效」，驗證：
  - 所有個別音效複選框被勾選
  - 遊戲中音效恢復播放

#### 2.2 個別音效控制
- [ ] 取消勾選「啟用此音效」（移動音效），驗證：
  - 移動棋子時沒有音效
  - 其他音效仍正常播放
- [ ] 重新勾選，驗證移動音效恢復

#### 2.3 音效檔案選擇
- [ ] 點擊「瀏覽...」按鈕，選擇自訂 WAV/MP3 檔案
- [ ] 驗證檔案路徑顯示在文字框中
- [ ] 移動棋子，驗證使用新音效

#### 2.4 音量調整
- [ ] 調整音量滑桿到 50%
- [ ] 點擊「▶ 預覽」按鈕，驗證音效播放且音量正確
- [ ] 調整音量到 0%，驗證預覽無聲
- [ ] 調整音量到 100%，驗證預覽最大音量

#### 2.5 預覽功能
- [ ] 點擊每個音效的「▶ 預覽」按鈕
- [ ] 驗證對應的音效正確播放
- [ ] 在預覽播放中再次點擊，驗證音效重新開始

#### 2.6 重設功能
- [ ] 選擇自訂音效檔案後點擊「🔄 重設」
- [ ] 驗證音效路徑清空，恢復為預設音效
- [ ] 點擊「🔄 重設所有音效為預設值」
- [ ] 驗證所有音效恢復預設設定

### 3. 棋子圖標設定測試

#### 3.1 棋子大小調整
- [ ] 移動「縮放比例」滑桿到 60%
- [ ] 返回遊戲，驗證棋子變小
- [ ] 再次進入設定，調整到 100%
- [ ] 返回遊戲，驗證棋子變大

#### 3.2 圖標集選擇
- [ ] 選擇「預設 Unicode 棋子符號」
- [ ] 返回遊戲，驗證顯示 Unicode 符號（♔ ♕ ♖ 等）
- [ ] 再次進入設定，選擇「自訂圖標」
- [ ] 驗證界面顯示對應選項

#### 3.3 重設功能
- [ ] 修改棋子大小和圖標集後點擊「🔄 重設為預設值」
- [ ] 驗證設定恢復預設（80% 大小，Unicode 符號）
- [ ] 返回遊戲，驗證棋盤顯示正確

### 4. 棋盤顏色設定測試

#### 4.1 顏色預覽
- [ ] 打開棋盤顏色設定標籤頁
- [ ] 驗證 2×2 預覽網格顯示當前顏色
- [ ] 驗證淺色和深色方格交替排列

#### 4.2 預設配色方案
測試每個預設配色方案：
- [ ] 點擊「經典棕褐色」，驗證：
  - 預覽網格更新
  - 返回遊戲後棋盤顏色改變
- [ ] 點擊「藍灰配色」，驗證效果
- [ ] 點擊「綠白配色」，驗證效果
- [ ] 點擊「紫粉配色」，驗證效果
- [ ] 點擊「木紋深色」，驗證效果
- [ ] 點擊「海洋藍配色」，驗證效果
- [ ] 點擊「淺色系」，驗證效果

#### 4.3 自訂顏色
- [ ] 點擊「選擇淺色方格顏色」
- [ ] 選擇一個自訂顏色（如紅色）
- [ ] 驗證預覽網格更新
- [ ] 返回遊戲，驗證淺色方格為紅色
- [ ] 點擊「選擇深色方格顏色」
- [ ] 選擇另一個自訂顏色（如藍色）
- [ ] 驗證預覽和棋盤都正確更新

#### 4.4 重設功能
- [ ] 設定自訂顏色後點擊「🔄 重設為預設值」
- [ ] 驗證恢復為經典棕褐色
- [ ] 返回遊戲，驗證棋盤顏色正確

### 5. 設定持久化測試

#### 5.1 音效設定持久化
- [ ] 修改音效設定（如音量、啟用狀態）
- [ ] 返回遊戲
- [ ] 關閉程式
- [ ] 重新啟動程式
- [ ] 打開音效設定，驗證設定保持

#### 5.2 棋子圖標持久化
- [ ] 修改棋子大小和圖標集
- [ ] 關閉程式
- [ ] 重新啟動程式
- [ ] 驗證棋盤顯示保持修改後的設定

#### 5.3 棋盤顏色持久化
- [ ] 選擇不同的配色方案
- [ ] 關閉程式
- [ ] 重新啟動程式
- [ ] 驗證棋盤顏色保持

### 6. 邊界條件測試

#### 6.1 視窗大小調整
- [ ] 打開設定面板
- [ ] 縮小視窗到最小尺寸
- [ ] 驗證滾動條出現，內容可滾動
- [ ] 驗證所有控件仍可操作
- [ ] 放大視窗，驗證佈局正常

#### 6.2 快速切換
- [ ] 快速在設定面板和遊戲畫面間切換
- [ ] 驗證無崩潰或UI錯亂
- [ ] 快速切換不同標籤頁
- [ ] 驗證內容正確顯示

#### 6.3 無效輸入處理
- [ ] 嘗試選擇不支援的音效檔案格式
- [ ] 驗證適當的錯誤處理或過濾
- [ ] 選擇顏色對話框後點擊取消
- [ ] 驗證顏色保持不變

### 7. 遊戲狀態測試

#### 7.1 遊戲進行中開啟設定
- [ ] 開始一局遊戲
- [ ] 移動幾個棋子
- [ ] 打開設定面板
- [ ] 修改設定
- [ ] 返回遊戲
- [ ] 驗證遊戲狀態保持（棋子位置、輪次等）
- [ ] 繼續遊戲，驗證功能正常

#### 7.2 回放模式下開啟設定
- [ ] 進入棋譜回放模式
- [ ] 打開設定面板
- [ ] 返回遊戲
- [ ] 驗證回放狀態保持

#### 7.3 線上遊戲中開啟設定
- [ ] 創建或加入線上房間
- [ ] 打開設定面板
- [ ] 返回遊戲
- [ ] 驗證連線狀態保持

### 8. 樣式和視覺測試

#### 8.1 樣式一致性
- [ ] 驗證設定面板使用與主遊戲一致的現代科技風格
- [ ] 驗證按鈕有懸停效果
- [ ] 驗證霓虹青色主題色正確應用

#### 8.2 文字和圖標
- [ ] 驗證所有emoji圖標正確顯示
- [ ] 驗證中文文字無亂碼
- [ ] 驗證字體大小適中可讀

#### 8.3 間距和對齊
- [ ] 驗證控件間距合理
- [ ] 驗證標籤和輸入框對齊
- [ ] 驗證滾動區域內邊距適當

## 已知限制

1. **自訂棋子圖標**：目前自訂圖標功能簡化，僅提供圖標集選擇，未實現完整的單個棋子圖片上傳功能。
2. **預覽音效**：需要確保音效檔案格式被 Qt 支援（建議使用 WAV）。
3. **顏色選擇**：QColorDialog 的樣式可能與主題不完全一致。

## 回歸測試

在完成以上測試後，執行以下回歸測試：

### 基本遊戲功能
- [ ] 新遊戲功能正常
- [ ] 移動棋子功能正常
- [ ] 特殊走法（王車易位、吃過路兵、兵升變）正常
- [ ] 將軍和將死檢測正常
- [ ] 音效播放正常（移動、吃子、將軍等）

### 進階功能
- [ ] 電腦對弈模式正常
- [ ] 線上對戰模式正常
- [ ] 時間控制功能正常
- [ ] 棋譜記錄和回放正常
- [ ] PGN 匯出功能正常

## 性能測試

- [ ] 打開設定面板響應時間 < 500ms
- [ ] 切換標籤頁響應時間 < 200ms
- [ ] 調整滑桿時UI更新流暢無卡頓
- [ ] 顏色預覽更新即時無延遲
- [ ] 記憶體使用正常，無明顯洩漏

## 測試報告模板

```
測試日期：____/____/____
測試人員：____________
Qt版本：____________
作業系統：____________

測試結果：
- 通過：___ 項
- 失敗：___ 項
- 未測試：___ 項

失敗項目詳情：
1. [描述問題]
2. [描述問題]

建議改進：
1. [改進建議]
2. [改進建議]
```

## 自動化測試建議

未來可考慮添加以下自動化測試：

1. **單元測試**：
   - 測試設定載入和保存函數
   - 測試 showSettingsPanel 和 hideSettingsPanel 函數

2. **整合測試**：
   - 測試設定變更後遊戲狀態正確更新
   - 測試多次切換設定面板的穩定性

3. **UI測試**：
   - 使用 Qt Test 框架自動化UI操作
   - 截圖比對驗證視覺效果

## 結論

完成本測試指南中的所有項目後，可以確保設定面板功能完整、穩定，並提供良好的用戶體驗。任何失敗的測試項目都應該被記錄並修復。
