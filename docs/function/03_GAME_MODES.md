# 遊戲模式

## 功能概述

Qt_Chess 提供三種遊戲模式：**雙人對弈**、**AI 人機對弈** 和 **線上對戰**。每種模式都提供完整的西洋棋體驗。

## 主要功能

### 1. 雙人對弈模式

#### 功能說明
本地雙人對戰模式，適合面對面的對局。

#### 特點
- 同一台電腦上兩人輪流操作
- 白棋和黑棋輪流下棋
- 適合坐在對面的對局
- 支援棋盤翻轉功能（見 [11_BOARD_FLIP.md](11_BOARD_FLIP.md)）

#### 適用場景
- 家庭娛樂
- 朋友對弈
- 教學示範
- 練習和學習

### 2. AI 人機對弈模式

#### 功能說明
與電腦 AI 對戰，整合 Stockfish 引擎，提供多種難度等級。

#### 特點
- 基於 Stockfish 引擎
- 可調難度（0-20 級）
- 可選擇執白或執黑
- 執黑時棋盤自動翻轉
- 顯示「電腦思考中...」提示

#### 難度等級
- **0-5 級**：初學者
- **6-10 級**：中級玩家
- **11-15 級**：進階玩家
- **16-20 級**：專家/大師級

詳見 [04_AI_COMPUTER_PLAY.md](04_AI_COMPUTER_PLAY.md)

### 3. 線上對戰模式

#### 功能說明
透過中央伺服器進行網路對戰，可與世界各地的對手對弈。

#### 特點
- 使用中央伺服器（WebSocket）
- 無需 IP 地址或網路設定
- 自動生成唯一房號
- 即時棋步同步
- 自動配色（房主白棋，加入者黑棋）
- 黑棋玩家棋盤自動翻轉
- 連線狀態顯示
- 斷線自動檢測

詳見 [05_ONLINE_MODE.md](05_ONLINE_MODE.md)

## 使用方法

### 開始雙人對弈

1. **啟動遊戲**
   - 點擊主選單「雙人」按鈕

2. **設定時間**（可選）
   - 選擇總時間（無限制或 30秒-60分鐘）
   - 設定每著加秒（0-60 秒）
   - 詳見 [06_TIME_CONTROL.md](06_TIME_CONTROL.md)

3. **開始對局**
   - 白棋先手
   - 輪流移動棋子

4. **對局進行**
   - 遵守回合制規則
   - 可隨時使用「新遊戲」重新開始
   - 可使用「放棄」按鈕認輸

### 開始 AI 對弈

1. **選擇模式**
   - 點擊主選單「電腦」按鈕

2. **選擇顏色**
   - 選擇「執白」或「執黑」
   - 執黑時棋盤自動翻轉

3. **調整難度**
   - 使用「電腦難度」滑桿設定 0-20 級

4. **設定時間**（可選）
   - 與雙人模式相同

5. **開始對局**
   - 玩家先手（執白）或等待電腦（執黑）
   - 電腦思考時顯示提示

### 開始線上對戰

#### 創建房間（房主）

1. 點擊主選單「線上」按鈕
2. 選擇「我要創建房間」
3. 點擊「複製房號」
4. 透過通訊軟體分享房號給朋友
5. 等待對手加入
6. 執白棋，開始對局

#### 加入房間（客人）

1. 點擊主選單「線上」按鈕
2. 選擇「我有房號」
3. 點擊「從剪貼簿貼上」（或手動輸入）
4. 點擊「開始」
5. 執黑棋，棋盤自動翻轉
6. 等待房主開始

## 模式切換

### 中途切換模式

- 點擊「返回主選單」
- 選擇新的遊戲模式
- 注意：切換會結束當前對局

### 重新開始

- 點擊「新遊戲」按鈕
- 或選擇「遊戲」選單 → 「新遊戲」
- 保持當前模式，重置棋盤

## 共通功能

所有模式都支援以下功能：

### 時間控制
- 設定總時間和每著加秒
- 計時器顯示和倒數
- 超時自動判負
- 詳見 [06_TIME_CONTROL.md](06_TIME_CONTROL.md)

### 棋譜記錄
- 自動記錄每一步
- 匯出 PGN 格式
- 複製到剪貼簿
- 詳見 [12_MOVE_RECORDING.md](12_MOVE_RECORDING.md)

### 回放功能
- 遊戲中或結束後回放
- 導航按鈕控制
- 回放時暫停計時器
- 詳見 [12_MOVE_RECORDING.md](12_MOVE_RECORDING.md)

### 音效
- 移動、吃子、將軍等音效
- 可自訂設定
- 詳見 [07_SOUND_EFFECTS.md](07_SOUND_EFFECTS.md)

### 自訂設定
- 棋子圖標（[09_PIECE_ICONS.md](09_PIECE_ICONS.md)）
- 棋盤顏色（[10_BOARD_COLORS.md](10_BOARD_COLORS.md)）
- 棋盤翻轉（[11_BOARD_FLIP.md](11_BOARD_FLIP.md)）
- 音效設定（[08_SOUND_SETTINGS.md](08_SOUND_SETTINGS.md)）

## 技術實現

### 遊戲模式列舉
```cpp
enum class GameMode {
    HumanVsHuman,       // 雙人對弈
    HumanVsComputer,    // 人機對弈（執白）
    ComputerVsHuman,    // 人機對弈（執黑）
    OnlineGame          // 線上對戰
};
```

### 模式管理
```cpp
void setGameMode(GameMode mode);
GameMode getCurrentGameMode() const;
void resetGame();
```

## 相關文檔

- [04_AI_COMPUTER_PLAY.md](04_AI_COMPUTER_PLAY.md) - AI 對弈詳細說明
- [05_ONLINE_MODE.md](05_ONLINE_MODE.md) - 線上模式詳細說明
- [06_TIME_CONTROL.md](06_TIME_CONTROL.md) - 時間控制功能
- [11_BOARD_FLIP.md](11_BOARD_FLIP.md) - 棋盤翻轉功能

## 程式碼參考

- `src/chessengine.h` - 遊戲模式定義
- `src/qt_chess.cpp` - 模式切換邏輯
- `src/networkmanager.h/cpp` - 線上對戰管理
