# 遊戲模式選擇功能 (Game Mode Selection Feature)

## 概述 (Overview)

此功能為線上對戰模式新增了五種遊戲模式選項，讓房主在創建房間時可以選擇不同的遊戲規則。

## 功能說明 (Feature Description)

### 1. 創建房間時選擇遊戲模式

當玩家點擊「創建房間」按鈕時，會彈出一個對話框，顯示以下內容：

#### 對話框內容：
```
線上對戰 - 簡易連線
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🎮 歡迎使用線上對戰！
使用中央伺服器連線，無需設定網路

選擇角色
┌─────────────────────────────┐
│ ○ 📱 我要創建房間（分享房號給朋友）  │
│ ○ 🔗 我有房號（加入朋友的房間）    │
└─────────────────────────────┘

🎯 選擇遊戲模式（可複選）
┌─────────────────────────────┐
│ ☑ ⚔️ 標準模式 - 經典國際象棋規則  │
│ ☐ ⚡ 快棋模式 - 限時10分鐘       │
│ ☐ 💨 閃電戰 - 限時3分鐘         │
│ ☐ 🎲 讓子模式 - 可移除部分棋子    │
│ ☐ 🔧 自訂規則 - 特殊變體玩法     │
└─────────────────────────────┘

💡 簡單說明：
• 創建房間：系統會給您一個房號，複製後傳給朋友
• 加入房間：把朋友給的房號貼上即可
• 房主（創建者）執白棋先走，加入者執黑棋
• 使用中央伺服器，無需設定路由器或防火牆

        [✓ 開始]  [✗ 取消]
```

### 2. 房間創建成功顯示

當房間創建成功後，會顯示包含所選遊戲模式的房間資訊：

```
🎉 房間已創建！
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

✅ 房間創建成功！

📱 請將以下房號傳給您的朋友：

┌────────────────┐
│     1234       │  (大字體顯示房號)
└────────────────┘

🎯 已選擇的遊戲模式
┌─────────────────────────────┐
│ ✓ 標準模式                   │
│ ✓ 快棋模式                   │
└─────────────────────────────┘

     [📋 複製房號]

房間資訊：
房間號碼：1234

💡 朋友收到房號後，選擇「加入房間」並貼上即可
🌐 使用中央伺服器，無需設定網路或防火牆

        [知道了]
```

### 3. 對手加入時的通知

當對手加入房間時，房主會收到包含遊戲模式資訊的通知：

```
🎮 對手已加入
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

✅ 對手已加入房間！

已選擇的遊戲模式：
• 標準模式
• 快棋模式

請按「開始」鍵開始遊戲

        [確定]
```

## 五種遊戲模式說明

1. **⚔️ 標準模式** - 經典國際象棋規則
   - 遵循 FIDE 標準規則
   - 默認選中

2. **⚡ 快棋模式** - 限時10分鐘
   - 每位玩家有 10 分鐘時間
   - 適合快節奏對局

3. **💨 閃電戰** - 限時3分鐘
   - 每位玩家有 3 分鐘時間
   - 極速對決

4. **🎲 讓子模式** - 可移除部分棋子
   - 用於不同水平玩家之間的公平對局
   - 可在遊戲開始前移除部分棋子

5. **🔧 自訂規則** - 特殊變體玩法
   - 支援各種象棋變體
   - 如：Chess960、三次重複、50步規則等

## 技術實現

### 修改的文件

1. **src/onlinedialog.h**
   - 新增遊戲模式相關的成員變數
   - 新增 `getGameModes()` 方法

2. **src/onlinedialog.cpp**
   - 在 UI 中添加遊戲模式選擇區域
   - 實現遊戲模式的啟用/停用邏輯
   - 實現 `getGameModes()` 方法

3. **src/qt_chess.h**
   - 新增 `m_selectedGameModes` 成員變數存儲選擇的模式

4. **src/qt_chess.cpp**
   - 修改 `onCreateRoomButtonClicked()` 以顯示模式選擇對話框
   - 修改 `showRoomInfoDialog()` 以顯示選擇的模式
   - 修改 `onOpponentJoined()` 以在對手加入時顯示模式通知

### 資料結構

使用 `QMap<QString, bool>` 存儲遊戲模式：
- Key: 模式名稱（中文）
- Value: 是否選中（true/false）

## 使用流程

1. 玩家 A 點擊「創建房間」
2. 彈出對話框，選擇「創建房間」並勾選想要的遊戲模式
3. 點擊「開始」
4. 顯示房間號碼和選擇的遊戲模式
5. 玩家 A 將房號分享給玩家 B
6. 玩家 B 使用房號加入房間
7. 玩家 A 收到通知，顯示對手已加入和選擇的遊戲模式
8. 玩家 A 點擊「開始」鍵開始遊戲

## 未來改進

- 將遊戲模式資訊傳送給房客，讓雙方都能看到選擇的模式
- 根據選擇的模式實際應用相應的遊戲規則
- 添加更多遊戲模式選項
- 允許自訂時間限制
